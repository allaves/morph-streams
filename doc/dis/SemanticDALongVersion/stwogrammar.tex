\section{\bigstwoo Grammar}
\label{sec:appendixStwoo}
%
We present below the grammar of the \stwoo mapping language.

\begin{lstlisting}[style=BNFStyle,language=BNF,label=list:schema,caption=Grammar of the \stwoo mapping language.]
BNF for S2O mapping descriptions

s2o::= import? dschema-description+ 
       stschema-description+ 
       conceptmapping-definition+ ontology+
import::= import literal
ontology::= ontology literal
literal::= '<string literal>'

BNF for schema descriptions

dschema-description::= dbschema-desc name 
                       documentation? (has-table table-desc)+ 
stschema-description::= streamschema-desc name 
                       documentation? 
                       (has-table table-desc)+
                       (has-stream stream-desc)+
name::= name literal
documentation::= documentation literal
table-desc::= name tabletype? documentation? 
              (column-description)+
tabletype::= tableType literal
stream-desc::= name streamtpe? documentation? 
               (column-description)+
streamtype::= streamType literal
column-description::= (keycol-desc |
                      forkeycol-desc | 
                      nonkeycol-desc | 
                      timestamp-desc) name 
                      columnType documentation? 
                      col-reference? 
                      implicit-col-reference?
columnType::= columnType datatype
col-reference::= refers-to literal
implicit-col-reference::= implicitlyrefers-to 
                          literal
datatype::=string | boolean | decimal | float | 
           double | date | integer 
           ... (XML Schema Datatypes)

BNF for concept mapping definitions

conceptmapping-definition::= conceptmap-def name 
                     documentation identified-by+ 
                     (uri-as transformation)? 
                     (described-by propertymap-def)* 
                     (applies-if cond-expr)? 
                     (joins-via join-list)? 
                     (union union-def)?
identified-by::= identified-by literal
join-list::= documentation? (hasjoin joindesc)+ 
                            (overwrites literal)?
joindesc::=(hasCol literal)+

BNF for condition expressions 

cond-expr::= orcond-expr | 
             AND andcond-expr orcond-expr
orcond-expr::= notcond-expr | 
               OR orcond-expr notcond-expr
notcond-expr::= condition | NOT condition
condition::= primitive-condition 
             (arg-restriction arg-restriction)*
primitive-condition::=lo_than | loorequal_than | 
              lo_than_str | loorequal_than_str | 
              hi_than | hiorequal_than | 
              hi_than_str | hiorequal_than_str | 
              equals | equals_str | in_keyword | 
              in_set | in_set_str | between | 
              between_str | date_before | 
              date_after | date_equal
arg-restriction::= parameter-selector restriction
parameter-selector::= on-param literal
restriction::= has-value constant-value | 
               has-column literal | 
               has-transform transformation 
constant-value::=datatype literal

BNF for transformations 

transformation::= primitive-transformation 
                  (arg-restriction arg-restriction)*
primitive-transformation::= get_nth_char | get _delimited | 
                     get_substring | concat | add_type | 
                     Subtract_type | Multiply_type | 
                     divide_type | constant

BNF for property mappings 

propertymap-def::=attributemap-def | relfromatt-def | 
                  relationmap-def
attributemap-def::= attributemap-def name use-dbcol* 
                    selector* documentation
relfromatt-def::=relfromatt-def name use-dbcol* 
                 selector* newobj-type? documentation?
relationmap-def::=relationmap-def to-concept
use-dbcol::=use-dbcol literal
selector::=selector (applies-if cond-expr)? 
           (aftertransform transformation)?
newobj-type::=newobject-type literal
to-concept::=to-concept literal}
union-def::=name (has-stream literal)+
\end{lstlisting}
